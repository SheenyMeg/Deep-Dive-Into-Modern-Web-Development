(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{17:function(e,t,n){e.exports=n(40)},40:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(16),s=n.n(o),l=n(3),c=n(1),u=n.n(c),i=n(2),d=n(4),m=n(6),g=n.n(m),f=null,p={getAll:function(){var e=Object(i.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("/blogs");case 2:return t=e.sent,e.abrupt("return",t.then((function(e){return e.data})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),token:f,setToken:function(e){f="bearer ".concat(e)},create:function(){var e=Object(i.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:f}},e.next=3,g.a.post("/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(i.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:f}},e.next=3,g.a.delete("".concat("/blogs","/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(i.a)(u.a.mark((function e(t,n){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:f}},e.next=3,g.a.put("".concat("/blogs","/").concat(t),n,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},b={login:function(){var e=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},v=function(){return g.a.get("/users").then((function(e){return e.data}))},w=function(e){var t=e.blog,n=e.handleRemove,o=e.handleAddLikes,s=Object(a.useState)(!1),l=Object(d.a)(s,2),c=l[0],u=l[1],i=function(){u(!c)},m={display:c?"":"none"};return r.a.createElement("div",{style:{paddingTop:10,paddingBottom:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},className:"blog"},r.a.createElement("div",null,r.a.createElement("b",null,"Title:")," ",t.title,c?r.a.createElement("button",{id:"hide",onClick:i},"hide"):r.a.createElement("button",{id:"view",className:"view-button",onClick:i},"view")),r.a.createElement("div",{style:m,className:"testBlog"},r.a.createElement("div",null," ",r.a.createElement("b",null,"Author:")," ",t.author,"  "),r.a.createElement("div",{className:"testUrl"}," ",r.a.createElement("b",null,"Url:")," ",t.url,"  "),r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement("div",{className:"testLike"},r.a.createElement("b",null,"Likes:")," ",t.likes),r.a.createElement("button",{id:"like",onClick:function(){return o(t.id)},style:{marginLeft:10}},"like")),r.a.createElement("button",{id:"remove",onClick:function(){return n(t.id)}},"remove")))},h=function(e){var t=e.notify,n={display:"none"};return"success"===t.status?r.a.createElement("div",{id:"success",style:t.show?{display:"block",color:"green",background:"lightgrey",fontSize:"15px",borderStyle:"solid",borderRadius:5,padding:10,marginbottom:10}:n},t.message):r.a.createElement("div",{id:"error",style:t.show?{display:"block",color:"red",background:"lightgrey",fontSize:"15px",borderStyle:"solid",borderRadius:5,padding:10,marginbottom:10}:n},t.message)},y=function(e){var t=e.loginObj,n=Object(a.useState)({username:"",password:""}),o=Object(d.a)(n,2),s=o[0],c=o[1];return r.a.createElement("div",{id:"loginForm"},r.a.createElement("h2",null,"Login"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({username:s.username,password:s.password})}},r.a.createElement("div",null,"username",r.a.createElement("input",{id:"username",autoComplete:"true",type:"text",value:s.username,name:"Username",onChange:function(e){c(Object(l.a)(Object(l.a)({},s),{},{username:e.target.value}))}})),r.a.createElement("div",null,"password",r.a.createElement("input",{id:"password",autoComplete:"true",type:"password",value:s.password,name:"Password",onChange:function(e){c(Object(l.a)(Object(l.a)({},s),{},{password:e.target.value}))}})),r.a.createElement("button",{type:"submit",id:"login-button"},"login")))},O=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),o=Object(d.a)(n,2),s=o[0],l=o[1],c={display:s?"none":""},u={display:s?"":"none"},i=function(){l(!s)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),r.a.createElement("div",null,r.a.createElement("div",{style:c,className:"loginButton"},r.a.createElement("button",{onClick:i},e.buttonLabel)),r.a.createElement("div",{style:u,className:"togglableContent"},e.children,r.a.createElement("button",{onClick:i},"cancel")))}));O.displayName="Togglable";var E=O,S=function(e){var t=e.createBlog,n=Object(a.useState)({title:"",author:"",url:""}),o=Object(d.a)(n,2),s=o[0],c=o[1];return r.a.createElement("div",{className:"blogFormDiv"},r.a.createElement("h2",{id:"create-new"},"Create new"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:s.title,author:s.author,url:s.url}),c({title:"",author:"",url:""})}},r.a.createElement("div",null,"title:",r.a.createElement("input",{id:"title",autoComplete:"true",type:"text",value:s.title,name:"title",onChange:function(e){c(Object(l.a)(Object(l.a)({},s),{},{title:e.target.value}))}})),r.a.createElement("div",null,"author:",r.a.createElement("input",{id:"author",autoComplete:"true",type:"text",value:s.author,name:"author",onChange:function(e){c(Object(l.a)(Object(l.a)({},s),{},{author:e.target.value}))}})),r.a.createElement("div",null,"url:",r.a.createElement("input",{id:"url",autoComplete:"true",type:"text",value:s.url,name:"url",onChange:function(e){c(Object(l.a)(Object(l.a)({},s),{},{url:e.target.value}))}})),r.a.createElement("button",{type:"submit",id:"create-blog"},"create")))},k=function(){var e=Object(a.useRef)(),t=Object(a.useRef)(),n=Object(a.useState)([]),o=Object(d.a)(n,2),s=o[0],c=o[1],m=Object(a.useState)(null),g=Object(d.a)(m,2),f=g[0],O=g[1],k=Object(a.useState)([]),j=Object(d.a)(k,2),x=j[0],N=j[1],B=Object(a.useState)(""),C=Object(d.a)(B,2),I=C[0],J=C[1],T=Object(a.useState)({status:"",message:"",show:!1}),L=Object(d.a)(T,2),A=L[0],R=L[1];Object(a.useEffect)((function(){v().then((function(e){return c(e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);O(t),p.setToken(t.token)}var n=window.localStorage.getItem("loggedSortBlogs");if(n){var a=JSON.parse(n);if(a.length>0){var r=a.sort((function(e,t){return e.likes<t.likes?1:-1}));N(r),window.localStorage.setItem("loggedSortBlogs",JSON.stringify(r))}else window.localStorage.setItem("loggedSortBlogs",JSON.stringify([]))}var o=window.localStorage.getItem("loggedName");if(o){var s=JSON.parse(o);J(s)}}),[]);var z=function(){var e=Object(i.a)(u.a.mark((function e(n){var a,r,o,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.login(n);case 3:(a=e.sent)&&(O(a),J(a.username),p.setToken(a.token),window.localStorage.setItem("loggedName",JSON.stringify(a.username)),window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),(r=s.find((function(e){return e.username===a.username})).blogs).length>0?(o=function(e,t){return e.likes<t.likes?1:-1},l=r.sort(o),N(l),window.localStorage.setItem("loggedSortBlogs",JSON.stringify(l))):window.localStorage.setItem("loggedSortBlogs",JSON.stringify([])),f&&t.current.toggleVisibility()),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),R({status:"fail",message:"Wrong username or password",show:!0}),setTimeout((function(){R({status:"",message:"",show:!1})}),5e3);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var t=Object(i.a)(u.a.mark((function t(n){var a,r,o,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.create(n);case 3:if(!(a=t.sent)){t.next=13;break}return N(x.concat(a)),e.current.toggleVisibility(),t.next=9,window.localStorage.getItem("loggedSortBlogs");case 9:(r=t.sent)&&(o=JSON.parse(r),s=o.concat(a),window.localStorage.setItem("loggedSortBlogs",JSON.stringify(s))),R({status:"success",message:"A new blog ".concat(n.title," created by ").concat(f.username),show:!0}),setTimeout((function(){R({status:"",message:"",show:!1})}),5e3);case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),R({status:"fail",message:"Invaild new blog created by ".concat(f.username),show:!0}),setTimeout((function(){R({status:"",message:"",show:!1})}),5e3);case 19:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),U=function(){var e=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.find((function(e){return e.id===t}));case 2:n=e.sent,window.confirm("Remove ".concat(n.title," by ").concat(I," ?"))&&V(t,n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(i.a)(u.a.mark((function e(t,n){var a,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.remove(t);case 3:N(x.filter((function(e){return e.id!==t}))),(a=window.localStorage.getItem("loggedSortBlogs"))&&(r=JSON.parse(a),o=r.filter((function(e){return e.id!==t})),window.localStorage.setItem("loggedSortBlogs",JSON.stringify(o))),R({status:"success",message:"Success removed ".concat(n.title," by ").concat(f.username),show:!0}),setTimeout((function(){R({status:"",message:"",show:!1})}),5e3),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),R({status:"fail",message:"Delete ".concat(n.title," failed by ").concat(f.username),show:!0}),setTimeout((function(){R({status:"",message:"",show:!1})}),5e3);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),F=function(e){var t=x.find((function(t){return t.id===e}));if(t){var n=Object(l.a)(Object(l.a)({},t),{},{likes:t.likes+=1});W(e,n)}},W=function(){var e=Object(i.a)(u.a.mark((function e(t,n){var a,r,o,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.update(t,n);case 3:(a=e.sent)&&((r=window.localStorage.getItem("loggedSortBlogs"))&&(o=JSON.parse(r),s=o.map((function(e){return e.id!==t?e:a})),window.localStorage.setItem("loggedSortBlogs",JSON.stringify(s))),R({status:"success",message:"like +1 for ".concat(n.title," by ").concat(f.username),show:!0}),setTimeout((function(){R({status:"",message:"",show:!1})}),5e3)),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),R({status:"fail",message:"failed like +1 for ".concat(n.title," failed by ").concat(f.username),show:!0}),setTimeout((function(){R({status:"",message:"",show:!1})}),5e3);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("h1",null,"Blogs"),r.a.createElement(h,{notify:A}),null===f?r.a.createElement(y,{loginObj:z}):r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("b",null,I)," logged in",r.a.createElement("button",{type:"reset",onClick:function(){window.confirm("Are you sure to log out?")&&(window.localStorage.clear(),window.location.reload(!1))}},"logout")),r.a.createElement("div",null,r.a.createElement(E,{buttonLabel:"log in",ref:t},r.a.createElement(y,{loginObj:z}))),r.a.createElement("div",null,r.a.createElement(E,{buttonLabel:"create new",ref:e},r.a.createElement(S,{createBlog:D}))),r.a.createElement("h2",null,"blog lists"),r.a.createElement("div",null,x&&x.length>0?x.map((function(e){return r.a.createElement(w,{key:e.id,blog:e,handleRemove:U,handleAddLikes:F})})):"Blog not yet added")))};s.a.render(r.a.createElement(k,null),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.3bc9c6a7.chunk.js.map